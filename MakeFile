# Nombre del compilador
CC = gcc

# Opciones de compilación
CFLAGS = -Wall -g

# Archivos fuente
SRCS = main.c calculos.c datos.c

# Archivos objeto y ensamblador
OBJS = $(SRCS:.c=.o)
ASSEMBLY = $(SRCS:.c=.s)

# Nombre del ejecutable
EXEC = programa

# Regla principal para construir el ejecutable
all: $(EXEC)

# Regla para generar el ejecutable
$(EXEC): $(OBJS)
	$(CC) $(CFLAGS) -o $(EXEC) $(OBJS)

# Regla para compilar cada archivo .c en .o
%.o: %.c
	$(CC) $(CFLAGS) -c $< -o $@

# Regla para generar archivos ensamblador .s de cada archivo .c
%.s: %.c
	$(CC) -S $< -o $@

# Dependencias específicas para cada archivo .o
main.o: main.c utils.h
calculos.o: calculos.c utils.h
datos.o: datos.c utils.h

# Limpiar archivos generados (.o, .s y ejecutable)
clean:
	rm -f $(OBJS) $(ASSEMBLY) $(EXEC)

# Regla para generar los archivos ensamblador manualmente
assembly: $(ASSEMBLY)

# Regla para compilar y generar todo (incluye ensamblador y ejecutable)
build: clean all assembly
